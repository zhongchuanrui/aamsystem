<!DOCTYPE html >
<html>
	<head>
		<meta http-equiv="Cache-Control" content="no-siteapp" />
		<link href="assets/css/bootstrap.min.css" rel="stylesheet" />
		<link rel="stylesheet" href="css/style.css" />
		<link href="assets/css/codemirror.css" rel="stylesheet">
		<link rel="stylesheet" href="assets/css/ace.min.css" />
		<link rel="stylesheet" href="font/css/font-awesome.min.css" />
		<script src="assets/js/jquery.min.js"></script>
		<script src="assets/js/bootstrap.min.js"></script>
		<script src="assets/js/typeahead-bs2.min.js"></script>
		<script src="assets/js/jquery.dataTables.min.js"></script>
		<script src="assets/js/jquery.dataTables.bootstrap.js"></script>
		<script src="assets/layer/layer.js" type="text/javascript"></script>
		<script src="assets/laydate/laydate.js" type="text/javascript"></script>
		<title>分类管理</title>
	</head>

	<body>
		<div class="page-content clearfix">
			<div class="sort_style">

				
				<div class="sort_list">
					<table class="table table-striped table-bordered table-hover" id="sample-table">
						<thead>
							<tr>
								<th width="25px"><label><input type="checkbox" class="ace"><span class="lbl"></span></label></th>
								<th width="50px">ID</th>
								<th width="100px">用户名</th>
								<th width="150px">密码</th>
								<th width="150px">注册时间</th>
								<th width="180px">性别</th>
								<th width="70px">状态</th>
								<th width="180px">操作</th>
							</tr>
						</thead>
						<tbody>
						
						</tbody>
					</table>
				</div>
			</div>
		</div>
		
		<!--活动详细-->
			<div id="Guestactivity" style="display:none">
				<div class="content_style">
					<div class="form-group"  ><label class="col-sm-3 control-label no-padding-right" for="form-field-1">校友编号： </label>
						<div class="col-sm-9" style="line-height:30px"  id="alumnus_id"></div>
					</div>
					<div class="form-group"  ><label class="col-sm-3 control-label no-padding-right" for="form-field-1">昵称： </label>
						<div class="col-sm-9"  style="line-height:30px" id="alumnus_nickname"></div>
					</div>
					<div class="form-group"  ><label class="col-sm-3 control-label no-padding-right" for="form-field-1">名字： </label>
						<div class="col-sm-9"  style="line-height:30px" id="alumnus_name"></div>
					</div>
					<div class="form-group"  ><label class="col-sm-3 control-label no-padding-right" for="form-field-1">注册时间： </label>
						<div class="col-sm-9" style="line-height:30px"  id="alumnus_registertime"></div>
					</div>
					<div class="form-group"  ><label class="col-sm-3 control-label no-padding-right" for="form-field-1">届别：  </label>
						<div class="col-sm-9"  style="line-height:30px" id="alumnus_session"></div>
					</div>
					<div class="form-group"  ><label class="col-sm-3 control-label no-padding-right" for="form-field-1">出生日期： </label>
						<div class="col-sm-9"  style="line-height:30px" id="alumnus_birthday"></div>
					</div>
					<div class="form-group"  ><label class="col-sm-3 control-label no-padding-right" for="form-field-1">性别： </label>
						<div class="col-sm-9"  style="line-height:30px" id="alumnus_sex"></div>
					</div>
					<div class="form-group"  ><label class="col-sm-3 control-label no-padding-right" for="form-field-1">简介： </label>
						<div class="col-sm-9" style="line-height:30px"  id="alumnus_introduce"></div>
					</div>
					<div class="form-group"  ><label class="col-sm-3 control-label no-padding-right" for="form-field-1">微信： </label>
						<div class="col-sm-9"  style="line-height:30px" id="alumnus_weixin"></div>
					</div>
					<div class="form-group"  ><label class="col-sm-3 control-label no-padding-right" for="form-field-1">QQ： </label>
						<div class="col-sm-9" style="line-height:30px"  id="alumnus_qq"></div>
					</div>
					<div class="form-group"  ><label class="col-sm-3 control-label no-padding-right" for="form-field-1">电话： </label>
						<div class="col-sm-9" style="line-height:30px"  id="alumnus_telephone"></div>
					</div>
					<div class="form-group"  ><label class="col-sm-3 control-label no-padding-right" for="form-field-1">学院： </label>
						<div class="col-sm-9" style="line-height:30px"  id="alumnus_academy"></div>
					</div>
					<div class="form-group"  ><label class="col-sm-3 control-label no-padding-right" for="form-field-1">本科专业： </label>
						<div class="col-sm-9" style="line-height:30px"  id="alumnus_major"></div>
					</div>
					<div class="form-group"  ><label class="col-sm-3 control-label no-padding-right" for="form-field-1">本科班级：</label>
						<div class="col-sm-9" style="line-height:30px"  id="alumnus_class"></div>
					</div>
					<div class="form-group"  ><label class="col-sm-3 control-label no-padding-right" for="form-field-1">本科毕业时间：</label>
						<div class="col-sm-9" style="line-height:30px"  id="alumnus_graduationtime"></div>
					</div>
					<div class="form-group"  ><label class="col-sm-3 control-label no-padding-right" for="form-field-1">硕士专业：</label>
						<div class="col-sm-9" style="line-height:30px"  id="alumnus_mastermajor"></div>
					</div>
					<div class="form-group"  ><label class="col-sm-3 control-label no-padding-right" for="form-field-1">硕士毕业时间：</label>
						<div class="col-sm-9" style="line-height:30px"  id="alumnus_masteryear"></div>
					</div>
					<div class="form-group"  ><label class="col-sm-3 control-label no-padding-right" for="form-field-1">住址：</label>
						<div class="col-sm-9" style="line-height:30px"  id="alumnus_address"></div>
					</div>
					<div class="form-group"  ><label class="col-sm-3 control-label no-padding-right" for="form-field-1">工作地点：</label>
						<div class="col-sm-9" style="line-height:30px"  id="alumnus_workplace"></div>
					</div>				
					<div class="form-group"  ><label class="col-sm-3 control-label no-padding-right" for="form-field-1">工作单位：</label>
						<div class="col-sm-9" style="line-height:30px"  id="alumnus_workpost"></div>
					</div>					
					
				</div>
			</div>

	</body>

</html>
<script type="text/javascript">
	jQuery(function($) {
		
		var oTable1 = $('#sample-table').dataTable({
			"aaSorting": [[1, "desc"]], //默认第几个排序
			"searching": false, //右边输入框关闭
			"bStateSave": true, //状态保存
			"ajax": {
	            "url": "http://localhost:8080/aamsystem/alumnus/getnewalumnus",
	            "dataSrc": ""
	        },
	        "columns": [
				{
				    "sClass": "text-center",
				    "data": "ID",
				    "render": function (data, type, full, meta) {
				        return '<label><input type="checkbox" class="ace"><span class="lbl"></span></label>';
				    },
				    "bSortable": false
				},
	            { "data": "alumnus_id" },
	            { "data": "alumnus_nickname" },
	            { "data": "alumnus_password" },
	            { "data": "alumnus_registertime" },
	            { "data": "alumnus_sex" },
	            { "data": "alumnus_state" },

	        ],
			"aoColumnDefs": [
				//{"bVisible": false, "aTargets": [ 3 ]} //控制列的隐藏显示
				{ "orderable": false, "aTargets": [0, 2, 3, 4, 5, 6, 7] }, // 制定列不参与排序
				{
                    "targets":7,
                    "class": "td-manage",
                    "data": null,
                    "bSortable": false,
                    "defaultContent": "<a href='javascript:;'  title='查看' class='showinfo btn btn-xs btn-info'><i class='fa fa-eye  bigger-120'></i></a><a href='javascript:;  title='删除'  class='delete btn btn-xs btn-pink'><i class='fa fa-trash  bigger-120'></i></a>",
                } 
			],
			"fnRowCallback" : function(nRow, data, iDisplayIndex) {  
	            /* 用来改写用户权限的 */  
	             if (data.alumnus_state == '1')  
	                   $('td:eq(6)', nRow).html('<span class="btn btn-xs btn-success">新注册</span>');
	             	 
	               return nRow;  
	           },  
		});
			
		$('table th input:checkbox').on('click', function() {
			var that = this;
			$(this).closest('table').find('tr > td:first-child input:checkbox')
				.each(function() {
					this.checked = that.checked;
					$(this).closest('tr').toggleClass('selected');
				});

		});
		//				$('[data-rel="tooltip"]').tooltip({placement: tooltip_placement});
		function tooltip_placement(context, source) {
			var $source = $(source);
			var $parent = $source.closest('table')
			var off1 = $parent.offset();
			var w1 = $parent.width();

			var off2 = $source.offset();
			var w2 = $source.width();

			if(parseInt(off2.left) < parseInt(off1.left) + parseInt(w1 / 2)) return 'right';
			return 'left';
		}
	});
	
	/*活动-审核*/
	$('#sample-table').on('click','.showinfo', function() {
	
		var table = $('#sample-table').DataTable();
	    var data = table.row($(this).parents('tr')).data();
	    console.debug(data);
	    $("#alumnus_id").html(data.alumnus_id);
	    $("#alumnus_nickname").html(data.alumnus_nickname);
	    $("#alumnus_name").html(data.alumnus_name);
	    $("#alumnus_registertime").html(data.alumnus_registertime);
	    $("#alumnus_session").html(data.alumnus_session);
	    $("#alumnus_birthday").html(data.alumnus_birthday);
	    $("#alumnus_sex").html(data.alumnus_sex);
	    $("#alumnus_introduce").html(data.alumnus_introduce);
	    $("#alumnus_weixin").html(data.alumnus_weixin);
	    $("#alumnus_qq").html(data.alumnus_qq);
	    $("#alumnus_telephone").html(data.alumnus_telephone);
	    $("#alumnus_academy").html(data.alumnus_academy);
	    $("#alumnus_major").html(data.alumnus_major);
	    $("#alumnus_class").html(data.alumnus_class);
	    $("#alumnus_graduationtime").html(data.alumnus_graduationtime);
	    $("#alumnus_mastermajor").html(data.alumnus_mastermajor);
	    $("#alumnus_masteryear").html(data.alumnus_masteryear);
	    $("#alumnus_address").html(data.alumnus_address);
	    $("#alumnus_workplace").html(data.alumnus_workplace);
	    $("#alumnus_workpost").html(data.alumnus_workpost);
	    
	    var remove = $(this); 
	    
	    layer.open({
			type: 1,
			title: '查看校友信息',
			maxmin: true,
			shadeClose: false, //点击遮罩关闭层
			area: ['900px', ''],
			content: $('#Guestactivity'),
			btn: ['确定',],
			yes: function(index, layero) {	
				var alumnus_id = $("#alumnus_id").html();				
				$.ajax({
					type : 'post',
					url : 'http://localhost:8080/aamsystem/alumnus/modifystate',
					dataType : 'json',
					data : {
						'alumnus_id':alumnus_id,
					},
					success : function(data){
						if(data >0 ){
							layer.alert('已查看！', {
								title: '提示框',
								icon: 1,
							});
							remove.parents('tr').remove();	
							
							layer.close(index);
						}else{
							layer.msg("请再查看");							
						}
					},
					error : function(){
						layer.msg("系统错误");
					}
				}); 
		},
		});			
	});

	/*活动-删除*/
	$('#sample-table tbody').on('click','.delete', function() {
		
		var table1 = $('#sample-table').DataTable();
	    var data = table1.row($(this).parents('tr')).data();
	    var activity_id= data.activity_id;		
	    var remove = $(this);   
		layer.confirm('确认要删除吗？', { icon: 0, }, function(index) {					
			$.ajax({
				type : 'post',
				url : 'http://localhost:8080/aamsystem/activity/deleteactivity',
				dataType : 'json',
				data : {
					'activity_id':activity_id
				},
				success : function(data){
					if(data >0 ){
						
						layer.alert('删除成功！', {
							title: '提示框',
							icon: 1,
						});
						remove.parents('tr').remove();	
						layer.close(index);
						layer.msg('已删除!', { icon: 1, time: 1000 });
					}else{
						layer.msg("删除失败！");						
					}
				},
				error : function(){
					layer.msg("系统错误");
				}
			}); 
			
		});
	});
	
</script>